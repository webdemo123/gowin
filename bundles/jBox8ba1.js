function jBox(n,t){this.options={id:null,width:"auto",height:"auto",minWidth:null,maxHeight:null,minWidth:null,maxHeight:null,attach:null,trigger:"click",preventDefault:!1,title:null,content:null,getTitle:null,getContent:null,ajax:{url:null,data:"",reload:!1,getData:"data-ajax",setContent:!0,spinner:!0},target:null,position:{x:"center",y:"center"},outside:null,offset:0,attributes:{x:"left",y:"top"},adjustPosition:!1,adjustTracker:!1,adjustDistance:5,fixed:!1,reposition:!1,repositionOnOpen:!0,repositionOnContent:!0,pointer:!1,pointTo:"target",fade:180,animation:null,theme:"Default",addClass:"",overlay:!1,zIndex:1e4,delayOpen:0,delayClose:0,closeOnEsc:!1,closeOnClick:!1,closeOnMouseleave:!1,closeButton:!1,constructOnInit:!1,blockScroll:!1,appendTo:jQuery("body"),draggable:null,dragOver:!0,onInit:function(){},onCreated:function(){},onOpen:function(){},onClose:function(){},onCloseComplete:function(){},confirmButton:"Submit",cancelButton:"Cancel",confirm:null,cancel:null,autoClose:7e3,color:null,stack:!0,audio:!1,volume:100,src:"href",gallery:"data-jbox-image",imageLabel:"title",imageFade:600,imageSize:"contain"};this.defaultOptions={Tooltip:{getContent:"title",trigger:"mouseenter",position:{x:"center",y:"top"},outside:"y",pointer:!0,adjustPosition:!0,reposition:!0},Mouse:{target:"mouse",position:{x:"right",y:"bottom"},offset:15,trigger:"mouseenter",adjustPosition:"flip"},Modal:{target:jQuery(window),fixed:!0,blockScroll:!0,closeOnEsc:!0,closeOnClick:"overlay",closeButton:!0,overlay:!0,animation:"zoomOut"},Confirm:{target:jQuery(window),fixed:!0,attach:jQuery("[data-confirm]"),getContent:"data-confirm",content:"Do you really want to do this?",minWidth:320,maxWidth:460,blockScroll:!0,closeOnEsc:!0,closeOnClick:"overlay",closeButton:!0,overlay:!0,animation:"zoomOut",preventDefault:!0,_onAttach:function(n){if(!this.options.confirm){var t=n.attr("onclick")?n.attr("onclick"):n.attr("href")?n.attr("target")?'window.open("'+n.attr("href")+'", "'+n.attr("target")+'");':'window.location.href = "'+n.attr("href")+'";':"";n.prop("onclick",null).data("jBox-Confirm-submit",t)}},_onCreated:function(){this.footer=jQuery('<div class="jBox-Confirm-footer"/>');jQuery('<div class="jBox-Confirm-button jBox-Confirm-button-cancel"/>').html(this.options.cancelButton).click(function(){this.options.cancel&&this.options.cancel();this.close()}.bind(this)).appendTo(this.footer);this.submitButton=jQuery('<div class="jBox-Confirm-button jBox-Confirm-button-submit"/>').html(this.options.confirmButton).appendTo(this.footer);this.footer.appendTo(this.container)},_onOpen:function(){this.submitButton.off("click.jBox-Confirm"+this.id).on("click.jBox-Confirm"+this.id,function(){this.options.confirm?this.options.confirm():eval(this.source.data("jBox-Confirm-submit"));this.close()}.bind(this))}},Notice:{target:jQuery(window),fixed:!0,position:{x:20,y:20},attributes:{x:"right",y:"top"},animation:"zoomIn",closeOnClick:"box",_onInit:function(){this.open();this.options.delayClose=this.options.autoClose;this.options.delayClose&&this.close()},_onCreated:function(){this.options.color&&this.wrapper.addClass("jBox-Notice-color jBox-Notice-"+this.options.color);this.wrapper.data("jBox-Notice-position",this.options.attributes.x+"-"+this.options.attributes.y)},_onOpen:function(){jQuery.each(jQuery(".jBox-Notice"),function(n,t){return t=jQuery(t),t.attr("id")!=this.id&&t.data("jBox-Notice-position")==this.options.attributes.x+"-"+this.options.attributes.y?this.options.stack?void t.css("margin-"+this.options.attributes.y,parseInt(t.css("margin-"+this.options.attributes.y))+this.wrapper.outerHeight()+10):void t.data("jBox").close({ignoreDelay:!0}):void 0}.bind(this));this.options.audio&&this.audio({url:this.options.audio,valume:this.options.volume})},_onCloseComplete:function(){this.destroy()}},Image:{target:jQuery(window),fixed:!0,blockScroll:!0,closeOnEsc:!0,closeOnClick:"overlay",closeButton:!0,overlay:!0,animation:"zoomOut",width:800,height:533,attach:jQuery("[data-jbox-image]"),preventDefault:!0,_onInit:function(){this.images=this.currentImage={};this.imageZIndex=1;this.attachedElements&&jQuery.each(this.attachedElements,function(n,t){if(t=jQuery(t),!t.data("jBox-image-gallery")){var i=t.attr(this.options.gallery)||"default";this.images[i]||(this.images[i]=[]);this.images[i].push({src:t.attr(this.options.src),label:t.attr(this.options.imageLabel)||""});"title"==this.options.imageLabel&&t.removeAttr("title");t.data("jBox-image-gallery",i);t.data("jBox-image-id",this.images[i].length-1)}}.bind(this));var n=function(n,t,i,r){if(!jQuery("#jBox-image-"+n+"-"+t).length){var u=jQuery("<div/>",{id:"jBox-image-"+n+"-"+t,"class":"jBox-image-container"}).css({backgroundImage:"url("+this.images[n][t].src+")",backgroundSize:this.options.imageSize,opacity:r?1:0,zIndex:i?0:this.imageZIndex++}).appendTo(this.content);jQuery("<div/>",{id:"jBox-image-label-"+n+"-"+t,"class":"jBox-image-label"+(r?" active":"")}).html(this.images[n][t].label).appendTo(this.imageLabel);r||i||u.animate({opacity:1},this.options.imageFade)}}.bind(this),t=function(n,t){jQuery(".jBox-image-label.active").removeClass("active");jQuery("#jBox-image-label-"+n+"-"+t).addClass("active")};this.showImage=function(i){var r,u,f;"open"!=i?(r=this.currentImage.gallery,u=this.currentImage.id+(1*("prev"==i)?-1:1),u=u>this.images[r].length-1?0:0>u?this.images[r].length-1:u):(r=this.source.data("jBox-image-gallery"),u=this.source.data("jBox-image-id"),jQuery(".jBox-image-pointer-prev, .jBox-image-pointer-next").css({display:this.images[r].length>1?"block":"none"}));(this.currentImage={gallery:r,id:u},jQuery("#jBox-image-"+r+"-"+u).length)?(jQuery("#jBox-image-"+r+"-"+u).css({zIndex:this.imageZIndex++,opacity:0}).animate({opacity:1},"open"==i?0:this.options.imageFade),t(r,u)):(this.wrapper.addClass("jBox-loading"),jQuery('<img src="'+this.images[r][u].src+'">').load(function(){n(r,u,!1);t(r,u);this.wrapper.removeClass("jBox-loading")}.bind(this)));f=u+1;f=f>this.images[r].length-1?0:0>f?this.images[r].length-1:f;jQuery("#jBox-image-"+r+"-"+f).length||jQuery('<img src="'+this.images[r][f].src+'">').load(function(){n(r,f,!0)})}},_onCreated:function(){this.imageLabel=jQuery("<div/>",{id:"jBox-image-label"}).appendTo(this.wrapper);this.wrapper.append(jQuery("<div/>",{"class":"jBox-image-pointer-prev",click:function(){this.showImage("prev")}.bind(this)})).append(jQuery("<div/>",{"class":"jBox-image-pointer-next",click:function(){this.showImage("next")}.bind(this)}))},_onOpen:function(){jQuery("body").addClass("jBox-image-open");jQuery(document).on("keyup.jBox-"+this.id,function(n){37==n.keyCode&&this.showImage("prev");39==n.keyCode&&this.showImage("next")}.bind(this));this.showImage("open")},_onClose:function(){jQuery("body").removeClass("jBox-image-open");jQuery(document).off("keyup.jBox-"+this.id)},_onCloseComplete:function(){this.wrapper.find(".jBox-image-container").css("opacity",0)}}};"string"==jQuery.type(n)&&(this.type=n,n=this.defaultOptions[n]);this.options=jQuery.extend(!0,this.options,n,t);null===this.options.id&&(this.options.id="jBoxID"+jBox._getUniqueID());this.id=this.options.id;("center"==this.options.position.x&&"x"==this.options.outside||"center"==this.options.position.y&&"y"==this.options.outside)&&(this.options.outside=!1);(!this.options.outside||"xy"==this.options.outside)&&(this.options.pointer=!1);"object"!=jQuery.type(this.options.offset)&&(this.options.offset={x:this.options.offset,y:this.options.offset});this.options.offset.x||(this.options.offset.x=0);this.options.offset.y||(this.options.offset.y=0);this.options.adjustDistance="object"!=jQuery.type(this.options.adjustDistance)?{top:this.options.adjustDistance,right:this.options.adjustDistance,bottom:this.options.adjustDistance,left:this.options.adjustDistance}:jQuery.extend({top:5,left:5,right:5,bottom:5},this.options.adjustDistance);this.align=this.options.outside&&"xy"!=this.options.outside?this.options.position[this.options.outside]:"center"!=this.options.position.y&&"number"!=jQuery.type(this.options.position.y)?this.options.position.x:"center"!=this.options.position.x&&"number"!=jQuery.type(this.options.position.x)?this.options.position.y:this.options.attributes.x;this.options.outside&&"xy"!=this.options.outside&&(this.outside=this.options.position[this.options.outside]);var i=navigator.userAgent.toLowerCase();return this.IE8=-1!=i.indexOf("msie")&&8==parseInt(i.split("msie")[1]),this.prefix=-1!=i.indexOf("webkit")?"-webkit-":"",this._getOpp=function(n){return{left:"right",right:"left",top:"bottom",bottom:"top",x:"y",y:"x"}[n]},this._getXY=function(n){return{left:"x",right:"x",top:"y",bottom:"y",center:"x"}[n]},this._getTL=function(n){return{left:"left",right:"left",top:"top",bottom:"top",center:"left",x:"left",y:"top"}[n]},this._supportsSVG=function(){return document.createElement("svg").getAttributeNS},this._createSVG=function(n,t){var i=document.createElementNS("http://www.w3.org/2000/svg",n);return jQuery.each(t,function(n,t){i.setAttribute(t[0],t[1]||"")}),i},this._appendSVG=function(n,t){return t.appendChild(n)},this._create=function(){var t,n,i;this.wrapper||((this.wrapper=jQuery("<div/>",{id:this.id,"class":"jBox-wrapper"+(this.type?" jBox-"+this.type:"")+(this.options.theme?" jBox-"+this.options.theme:"")+(this.options.addClass?" "+this.options.addClass:"")+(this.IE8?" jBox-IE8":"")}).css({position:this.options.fixed?"fixed":"absolute",display:"none",opacity:0,zIndex:this.options.zIndex}).data("jBox",this),this.options.closeOnMouseleave&&this.wrapper.mouseleave(function(n){this.source&&!(n.relatedTarget==this.source[0]||-1!==jQuery.inArray(this.source[0],jQuery(n.relatedTarget).parents("*")))&&this.close()}.bind(this)),"box"==this.options.closeOnClick&&this.wrapper.on("touchend click",function(){this.close({ignoreDelay:!0})}.bind(this)),this.container=jQuery("<div/>",{"class":"jBox-container"}).appendTo(this.wrapper),this.content=jQuery("<div/>",{"class":"jBox-content"}).css({width:this.options.width,height:this.options.height,minWidth:this.options.minWidth,minHeight:this.options.minHeight,maxWidth:this.options.maxWidth,maxHeight:this.options.maxHeight}).appendTo(this.container),this.options.closeButton)&&((this.closeButton=jQuery("<div/>",{"class":"jBox-closeButton jBox-noDrag"}).on("touchend click",function(){this.isOpen&&this.close({ignoreDelay:!0})}.bind(this)),this._supportsSVG())?(t=this._createSVG("svg",[["viewBox","0 0 24 24"]]),this._appendSVG(this._createSVG("path",[["d","M22.2,4c0,0,0.5,0.6,0,1.1l-6.8,6.8l6.9,6.9c0.5,0.5,0,1.1,0,1.1L20,22.3c0,0-0.6,0.5-1.1,0L12,15.4l-6.9,6.9c-0.5,0.5-1.1,0-1.1,0L1.7,20c0,0-0.5-0.6,0-1.1L8.6,12L1.7,5.1C1.2,4.6,1.7,4,1.7,4L4,1.7c0,0,0.6-0.5,1.1,0L12,8.5l6.8-6.8c0.5-0.5,1.1,0,1.1,0L22.2,4z"]]),t),this.closeButton.append(t)):this.wrapper.addClass("jBox-nosvg"),"box"!=this.options.closeButton&&(this.options.closeButton!==!0||this.options.overlay||this.options.title)||(this.wrapper.addClass("jBox-closeButton-box"),this.closeButton.appendTo(this.container))),(this.wrapper.appendTo(this.options.appendTo),this.options.pointer)&&((this.pointer={position:"target"!=this.options.pointTo?this.options.pointTo:this._getOpp(this.outside),xy:this._getXY("target"!=this.options.pointTo?this.options.pointTo:this.outside),align:"center",offset:0},this.pointer.element=jQuery("<div/>",{"class":"jBox-pointer jBox-pointer-"+this.pointer.position}).appendTo(this.wrapper),this.pointer.dimensions={x:this.pointer.element.outerWidth(),y:this.pointer.element.outerHeight()},"string"==jQuery.type(this.options.pointer))&&(n=this.options.pointer.split(":"),n[0]&&(this.pointer.align=n[0]),n[1]&&(this.pointer.offset=parseInt(n[1]))),this.pointer.alignAttribute="x"==this.pointer.xy?"bottom"==this.pointer.align?"bottom":"top":"right"==this.pointer.align?"right":"left",this.wrapper.css("padding-"+this.pointer.position,this.pointer.dimensions[this.pointer.xy]),this.pointer.element.css(this.pointer.alignAttribute,"center"==this.pointer.align?"50%":0).css("margin-"+this.pointer.alignAttribute,this.pointer.offset),this.pointer.margin={},this.pointer.margin["margin-"+this.pointer.alignAttribute]=this.pointer.offset,"center"==this.pointer.align&&this.pointer.element.css(this.prefix+"transform","translate("+("y"==this.pointer.xy?this.pointer.dimensions.x*-.5+"px":0)+", "+("x"==this.pointer.xy?this.pointer.dimensions.y*-.5+"px":0)+")"),this.pointer.element.css("x"==this.pointer.xy?"width":"height",parseInt(this.pointer.dimensions[this.pointer.xy])+parseInt(this.container.css("border-"+this.pointer.alignAttribute+"-width"))),this.wrapper.addClass("jBox-pointerPosition-"+this.pointer.position)),(this.setContent(this.options.content,!0),this.setTitle(this.options.title,!0),this.options.draggable)&&(i="title"==this.options.draggable?this.titleContainer:this.options.draggable.length>0?this.options.draggable:this.options.draggable.selector?jQuery(this.options.draggable.selector):this.wrapper,i.addClass("jBox-draggable").on("mousedown",function(n){if(2!=n.button&&!jQuery(n.target).hasClass("jBox-noDrag")&&!jQuery(n.target).parents(".jBox-noDrag").length){this.options.dragOver&&this.wrapper.css("zIndex")<=jBox.zIndexMax&&(jBox.zIndexMax+=1,this.wrapper.css("zIndex",jBox.zIndexMax));var t=this.wrapper.outerHeight(),i=this.wrapper.outerWidth(),r=this.wrapper.offset().top+t-n.pageY,u=this.wrapper.offset().left+i-n.pageX;jQuery(document).on("mousemove.jBox-draggable-"+this.id,function(n){this.wrapper.offset({top:n.pageY+r-t,left:n.pageX+u-i})}.bind(this));n.preventDefault()}}.bind(this)).on("mouseup",function(){jQuery(document).off("mousemove.jBox-draggable-"+this.id)}.bind(this)),jBox.zIndexMax=jBox.zIndexMax?Math.max(jBox.zIndexMax,this.options.zIndex):this.options.zIndex),this.options.onCreated.bind(this)(),this.options._onCreated&&this.options._onCreated.bind(this)())},this.options.constructOnInit&&this._create(),this.options.attach&&this.attach(),this._positionMouse=function(n){this.pos={left:n.pageX,top:n.pageY};var t=function(n,t){return"center"==this.options.position[t]?void(this.pos[n]-=Math.ceil(this.dimensions[t]/2)):(this.pos[n]+=n==this.options.position[t]?-1*this.dimensions[t]-this.options.offset[t]:this.options.offset[t],this.pos[n])}.bind(this);this.wrapper.css({left:t("left","x"),top:t("top","y")});this.targetDimensions={x:0,y:0,left:n.pageX,top:n.pageY};this._adjustPosition()},this._attachEvents=function(){if(this.options.closeOnEsc&&jQuery(document).on("keyup.jBox-"+this.id,function(n){27==n.keyCode&&this.close({ignoreDelay:!0})}.bind(this)),(this.options.closeOnClick===!0||"body"==this.options.closeOnClick)&&jQuery(document).on("touchend.jBox-"+this.id+" click.jBox-"+this.id,function(n){this.blockBodyClick||"body"==this.options.closeOnClick&&(n.target==this.wrapper[0]||this.wrapper.has(n.target).length)||this.close({ignoreDelay:!0})}.bind(this)),(this.options.adjustPosition&&this.options.adjustTracker||this.options.reposition)&&!this.fixed&&this.outside){var n,t=0,i=150,r=function(){var r=(new Date).getTime();n||(r-t>i&&(this.options.reposition&&this.position(),this.options.adjustTracker&&this._adjustPosition(),t=r),n=setTimeout(function(){n=null;t=(new Date).getTime();this.options.reposition&&this.position();this.options.adjustTracker&&this._adjustPosition()}.bind(this),i))}.bind(this);this.options.adjustTracker&&"resize"!=this.options.adjustTracker&&jQuery(window).on("scroll.jBox-"+this.id,function(){r()}.bind(this));(this.options.adjustTracker&&"scroll"!=this.options.adjustTracker||this.options.reposition)&&jQuery(window).on("resize.jBox-"+this.id,function(){r()}.bind(this))}"mouse"==this.options.target&&jQuery("body").on("mousemove.jBox-"+this.id,function(n){this._positionMouse(n)}.bind(this))},this._detachEvents=function(){this.options.closeOnEsc&&jQuery(document).off("keyup.jBox-"+this.id);(this.options.closeOnClick===!0||"body"==this.options.closeOnClick)&&jQuery(document).off("touchend.jBox-"+this.id+" click.jBox-"+this.id);(this.options.adjustPosition&&this.options.adjustTracker||this.options.reposition)&&(jQuery(window).off("scroll.jBox-"+this.id),jQuery(window).off("resize.jBox-"+this.id));"mouse"==this.options.target&&jQuery("body").off("mousemove.jBox-"+this.id)},this._addOverlay=function(){this.overlay||(this.overlay=jQuery("#jBox-overlay").length?jQuery("#jBox-overlay").css({zIndex:Math.min(jQuery("#jBox-overlay").css("z-index"),this.options.zIndex-1)}):jQuery("<div/>",{id:"jBox-overlay"}).css({display:"none",opacity:0,zIndex:this.options.zIndex-1}).appendTo(jQuery("body")),("overlay"==this.options.closeButton||this.options.closeButton===!0)&&(jQuery("#jBox-overlay .jBox-closeButton").length>0?jQuery("#jBox-overlay .jBox-closeButton").on("touchend click",function(){this.isOpen&&this.close({ignoreDelay:!0})}.bind(this)):this.overlay.append(this.closeButton)),"overlay"==this.options.closeOnClick&&this.overlay.on("touchend click",function(){this.isOpen&&this.close({ignoreDelay:!0})}.bind(this)));var n=this.overlay.data("jBox")||{};n["jBox-"+this.id]=!0;this.overlay.data("jBox",n);"block"!=this.overlay.css("display")&&(this.options.fade?this.overlay.stop()&&this.overlay.animate({opacity:1},{queue:!1,duration:this.options.fade,start:function(){this.overlay.css({display:"block"})}.bind(this)}):this.overlay.css({display:"block",opacity:1}))},this._removeOverlay=function(){if(this.overlay){var n=this.overlay.data("jBox");delete n["jBox-"+this.id];this.overlay.data("jBox",n);jQuery.isEmptyObject(n)&&(this.options.fade?this.overlay.stop()&&this.overlay.animate({opacity:0},{queue:!1,duration:this.options.fade,complete:function(){this.overlay.css({display:"none"})}.bind(this)}):this.overlay.css({display:"none",opacity:0}))}},this._generateCSS=function(){var n,i,t;this.IE8||("object"!=jQuery.type(this.options.animation)&&(this.options.animation={pulse:{open:"pulse",close:"zoomOut"},zoomIn:{open:"zoomIn",close:"zoomIn"},zoomOut:{open:"zoomOut",close:"zoomOut"},move:{open:"move",close:"move"},slide:{open:"slide",close:"slide"},flip:{open:"flip",close:"flip"},tada:{open:"tada",close:"zoomOut"}}[this.options.animation]),this.options.animation.open&&(this.options.animation.open=this.options.animation.open.split(":")),this.options.animation.close&&(this.options.animation.close=this.options.animation.close.split(":")),this.options.animation.openDirection=this.options.animation.open?this.options.animation.open[1]:null,this.options.animation.closeDirection=this.options.animation.close?this.options.animation.close[1]:null,this.options.animation.open&&(this.options.animation.open=this.options.animation.open[0]),this.options.animation.close&&(this.options.animation.close=this.options.animation.close[0]),this.options.animation.open&&(this.options.animation.open+="Open"),this.options.animation.close&&(this.options.animation.close+="Close"),n={pulse:{duration:350,css:[["0%","scale(1)"],["50%","scale(1.1)"],["100%","scale(1)"]]},zoomInOpen:{duration:this.options.fade||180,css:[["0%","scale(0.9)"],["100%","scale(1)"]]},zoomInClose:{duration:this.options.fade||180,css:[["0%","scale(1)"],["100%","scale(0.9)"]]},zoomOutOpen:{duration:this.options.fade||180,css:[["0%","scale(1.1)"],["100%","scale(1)"]]},zoomOutClose:{duration:this.options.fade||180,css:[["0%","scale(1)"],["100%","scale(1.1)"]]},moveOpen:{duration:this.options.fade||180,positions:{top:{"0%":-12},right:{"0%":12},bottom:{"0%":12},left:{"0%":-12}},css:[["0%","translate%XY(%Vpx)"],["100%","translate%XY(0px)"]]},moveClose:{duration:this.options.fade||180,timing:"ease-in",positions:{top:{"100%":-12},right:{"100%":12},bottom:{"100%":12},left:{"100%":-12}},css:[["0%","translate%XY(0px)"],["100%","translate%XY(%Vpx)"]]},slideOpen:{duration:400,positions:{top:{"0%":-400},right:{"0%":400},bottom:{"0%":400},left:{"0%":-400}},css:[["0%","translate%XY(%Vpx)"],["100%","translate%XY(0px)"]]},slideClose:{duration:400,timing:"ease-in",positions:{top:{"100%":-400},right:{"100%":400},bottom:{"100%":400},left:{"100%":-400}},css:[["0%","translate%XY(0px)"],["100%","translate%XY(%Vpx)"]]},flipOpen:{duration:600,css:[["0%","perspective(400px) rotateX(90deg)"],["40%","perspective(400px) rotateX(-15deg)"],["70%","perspective(400px) rotateX(15deg)"],["100%","perspective(400px) rotateX(0deg)"]]},flipClose:{duration:this.options.fade||300,css:[["0%","perspective(400px) rotateX(0deg)"],["100%","perspective(400px) rotateX(90deg)"]]},tada:{duration:800,css:[["0%","scale(1)"],["10%, 20%","scale(0.9) rotate(-3deg)"],["30%, 50%, 70%, 90%","scale(1.1) rotate(3deg)"],["40%, 60%, 80%","scale(1.1) rotate(-3deg)"],["100%","scale(1) rotate(0)"]]}},jQuery.each(["pulse","tada"],function(t,i){n[i+"Open"]=n[i+"Close"]=n[i]}),i=function(t,i){return keyframe_css="@"+this.prefix+"keyframes jBox-animation-"+this.options.animation[t]+"-"+t+(i?"-"+i:"")+" {",jQuery.each(n[this.options.animation[t]].css,function(r,u){var f=i?u[1].replace("%XY",this._getXY(i).toUpperCase()):u[1];n[this.options.animation[t]].positions&&(f=f.replace("%V",n[this.options.animation[t]].positions[i][u[0]]));keyframe_css+=u[0]+" {"+this.prefix+"transform:"+f+";}"}.bind(this)),keyframe_css+="}",keyframe_css+=".jBox-animation-"+this.options.animation[t]+"-"+t+(i?"-"+i:"")+" {",keyframe_css+=this.prefix+"animation-duration: "+n[this.options.animation[t]].duration+"ms;",keyframe_css+=this.prefix+"animation-name: jBox-animation-"+this.options.animation[t]+"-"+t+(i?"-"+i:"")+";",keyframe_css+=n[this.options.animation[t]].timing?this.prefix+"animation-timing-function: "+n[this.options.animation[t]].timing+";":"",keyframe_css+="}"}.bind(this),t="",jQuery.each(["open","close"],function(r,u){return this.options.animation[u]&&n[this.options.animation[u]]&&("close"!=u||this.options.fade)?void(n[this.options.animation[u]].positions?jQuery.each(["top","right","bottom","left"],function(n,r){t+=i(u,r)}):t+=i(u)):""}.bind(this)),jQuery("<style/>").append(t).appendTo(jQuery("head")))},this._blockBodyClick=function(){this.blockBodyClick=!0;setTimeout(function(){this.blockBodyClick=!1}.bind(this),10)},this.options.animation&&this._generateCSS(),this._animate=function(n){var t,r,i;if(!this.IE8){if(n||(n=this.isOpen?"open":"close"),!this.options.fade&&"close"==n)return null;t=this.options.animation[n+"Direction"]||("center"!=this.align?this.align:this.options.attributes.x);this.flipped&&this._getXY(t)==this._getXY(this.align)&&(t=this._getOpp(t));r="jBox-animation-"+this.options.animation[n]+"-"+n+" jBox-animation-"+this.options.animation[n]+"-"+n+"-"+t;this.wrapper.addClass(r);i=1e3*parseFloat(this.wrapper.css(this.prefix+"animation-duration"));"close"==n&&(i=Math.min(i,this.options.fade));setTimeout(function(){this.wrapper.removeClass(r)}.bind(this),i)}},this._abortAnimation=function(){if(!this.IE8){var n="jBox-animation",t=this.wrapper.attr("class").split(" ").filter(function(t){return 0!==t.lastIndexOf(n,0)});this.wrapper.attr("class",t.join(" "))}},this._adjustPosition=function(){var i,t,n,f;if(!this.options.adjustPosition)return null;this.positionAdjusted&&(this.wrapper.css(this.pos),this.pointer&&this.wrapper.css("padding",0).css("padding-"+this._getOpp(this.outside),this.pointer.dimensions[this._getXY(this.outside)]).removeClass("jBox-pointerPosition-"+this._getOpp(this.pointer.position)).addClass("jBox-pointerPosition-"+this.pointer.position),this.pointer&&this.pointer.element.attr("class","jBox-pointer jBox-pointer-"+this._getOpp(this.outside)).css(this.pointer.margin),this.positionAdjusted=!1,this.flipped=!1);i=jQuery(window);t={x:i.width(),y:i.height(),top:this.options.fixed&&this.target.data("jBox-fixed")?0:i.scrollTop(),left:this.options.fixed&&this.target.data("jBox-fixed")?0:i.scrollLeft()};t.bottom=t.top+t.y;t.right=t.left+t.x;var e=t.top>this.pos.top-(this.options.adjustDistance.top||0),o=t.right<this.pos.left+this.dimensions.x+(this.options.adjustDistance.right||0),s=t.bottom<this.pos.top+this.dimensions.y+(this.options.adjustDistance.bottom||0),h=t.left>this.pos.left-(this.options.adjustDistance.left||0),r=h?"left":o?"right":null,u=e?"top":s?"bottom":null,c=r||u;c&&("move"==this.options.adjustPosition||r!=this.outside&&u!=this.outside||("mouse"==this.target&&(this.outside="right"),("top"==this.outside||"left"==this.outside?t[this._getXY(this.outside)]-(this.targetDimensions[this._getTL(this.outside)]-t[this._getTL(this.outside)])-this.targetDimensions[this._getXY(this.outside)]+this.options.offset[this._getXY(this.outside)]:this.targetDimensions[this._getTL(this.outside)]-t[this._getTL(this.outside)]-this.options.offset[this._getXY(this.outside)])>this.dimensions[this._getXY(this.outside)]+parseInt(this.options.adjustDistance[this._getOpp(this.outside)])&&(this.wrapper.css(this._getTL(this.outside),this.pos[this._getTL(this.outside)]+(this.dimensions[this._getXY(this.outside)]+this.options.offset[this._getXY(this.outside)]*("top"==this.outside||"left"==this.outside?-2:2)+this.targetDimensions[this._getXY(this.outside)])*("top"==this.outside||"left"==this.outside?1:-1)),this.pointer&&this.wrapper.removeClass("jBox-pointerPosition-"+this.pointer.position).addClass("jBox-pointerPosition-"+this._getOpp(this.pointer.position)).css("padding",0).css("padding-"+this.outside,this.pointer.dimensions[this._getXY(this.outside)]),this.pointer&&this.pointer.element.attr("class","jBox-pointer jBox-pointer-"+this.outside),this.positionAdjusted=!0,this.flipped=!0)),n="x"==this._getXY(this.outside)?u:r,this.pointer&&"flip"!=this.options.adjustPosition&&this._getXY(n)==this._getOpp(this._getXY(this.outside))&&(f="center"==this.pointer.align?this.dimensions[this._getXY(n)]/2-this.pointer.dimensions[this._getOpp(this.pointer.xy)]/2-parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))*(n!=this._getTL(n)?-1:1):n==this.pointer.alignAttribute?parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute)):this.dimensions[this._getXY(n)]-parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))-this.pointer.dimensions[this._getXY(n)],spaceDiff=n==this._getTL(n)?t[this._getTL(n)]-this.pos[this._getTL(n)]+this.options.adjustDistance[n]:-1*(t[this._getOpp(this._getTL(n))]-this.pos[this._getTL(n)]-this.options.adjustDistance[n]-this.dimensions[this._getXY(n)]),n==this._getOpp(this._getTL(n))&&this.pos[this._getTL(n)]-spaceDiff<t[this._getTL(n)]+this.options.adjustDistance[this._getTL(n)]&&(spaceDiff-=t[this._getTL(n)]+this.options.adjustDistance[this._getTL(n)]-(this.pos[this._getTL(n)]-spaceDiff)),spaceDiff=Math.min(spaceDiff,f),f>=spaceDiff&&spaceDiff>0&&(this.pointer.element.css("margin-"+this.pointer.alignAttribute,parseInt(this.pointer.element.css("margin-"+this.pointer.alignAttribute))-spaceDiff*(n!=this.pointer.alignAttribute?-1:1)),this.wrapper.css(this._getTL(n),this.pos[this._getTL(n)]+spaceDiff*(n!=this._getTL(n)?-1:1)),this.positionAdjusted=!0)))},this.options.onInit.bind(this)(),this.options._onInit&&this.options._onInit.bind(this)(),this}jBox.prototype.attach=function(n,t){return n||(n=jQuery(this.options.attach.selector||this.options.attach)),t||(t=this.options.trigger),n&&n.length&&jQuery.each(n,function(n,i){i=jQuery(i);i.data("jBox-attached-"+this.id)||("title"==this.options.getContent&&void 0!=i.attr("title")&&i.data("jBox-getContent",i.attr("title")).removeAttr("title"),this.attachedElements||(this.attachedElements=[]),this.attachedElements.push(i[0]),i.on(t+".jBox-attach-"+this.id,function(n){if(this.timer&&clearTimeout(this.timer),"mouseenter"!=t||!this.isOpen||this.source[0]!=i[0]){if(this.isOpen&&this.source&&this.source[0]!=i[0]);this.source=i;!this.options.target&&(this.target=i);"click"==t&&this.options.preventDefault&&n.preventDefault();this["click"!=t||!0?"open":"toggle"]()}}.bind(this)),"mouseenter"==this.options.trigger&&i.on("mouseleave",function(n){this.options.closeOnMouseleave&&(n.relatedTarget==this.wrapper[0]||jQuery(n.relatedTarget).parents("#"+this.id).length)||this.close()}.bind(this)),i.data("jBox-attached-"+this.id,t),this.options._onAttach&&this.options._onAttach.bind(this)(i))}.bind(this)),this};jBox.prototype.detach=function(n){return n||(n=this.attachedElements||[]),n&&n.length&&jQuery.each(n,function(n,t){t=jQuery(t);t.data("jBox-attached-"+this.id)&&(t.off(t.data("jBox-attached-"+this.id)+".jBox-attach-"+this.id),t.data("jBox-attached-"+this.id,null));this.attachedElements=jQuery.grep(this.attachedElements,function(n){return n!=t[0]})}.bind(this)),this};jBox.prototype.setTitle=function(n,t){var i=this.wrapper.height(),r=this.wrapper.width();return null==n||void 0==n?this:(!this.wrapper&&this._create(),this.title||(this.titleContainer=jQuery("<div/>",{"class":"jBox-title"}),this.title=jQuery("<div/>").appendTo(this.titleContainer),this.wrapper.addClass("jBox-hasTitle"),("title"==this.options.closeButton||this.options.closeButton===!0&&!this.options.overlay)&&(this.wrapper.addClass("jBox-closeButton-title"),this.closeButton.appendTo(this.titleContainer)),this.titleContainer.insertBefore(this.content)),this.title.html(n),!t&&this.options.repositionOnContent&&(i!=this.wrapper.height()||r!=this.wrapper.width())&&this.position(),this)};jBox.prototype.setContent=function(n,t){var i;if(null==n)return this;this.wrapper||this._create();var r=this.wrapper.height(),u=this.wrapper.width(),f=jQuery("body").height(),e=jQuery("body").width();switch(this.content.children("[data-jbox-content-appended]").appendTo("body").css({display:"none"}),jQuery.type(n)){case"string":this.content.html(n);break;case"object":this.content.html("");n.attr("data-jbox-content-appended",1).appendTo(this.content).css({display:"block"})}return i={x:e-jQuery("body").width(),y:f-jQuery("body").height()},!t&&this.options.repositionOnContent&&(r!=this.wrapper.height()||u!=this.wrapper.width())&&this.position({adjustOffset:i}),this};jBox.prototype.setDimensions=function(n,t,i){this.wrapper||this._create();this.content.css(n,t);(void 0==i||i)&&this.position()};jBox.prototype.setWidth=function(n,t){this.setDimensions("width",n,t)};jBox.prototype.setHeight=function(n,t){this.setDimensions("height",n,t)};jBox.prototype.position=function(n){var t,r,i;if(n||(n={}),this.target=n.target||this.target||this.options.target||jQuery(window),this.dimensions={x:this.wrapper.outerWidth(),y:this.wrapper.outerHeight()},"mouse"!=this.target){if("center"==this.options.position.x&&"center"==this.options.position.y)return this.wrapper.css({left:"50%",top:"50%",marginLeft:this.dimensions.x*-.5+this.options.offset.x,marginTop:this.dimensions.y*-.5+this.options.offset.y}),this;if(t=this.target.offset(),this.target.data("jBox-fixed")||this.target.data("jBox-fixed",this.target[0]==jQuery(window)[0]||"fixed"!=this.target.css("position")&&this.target.parents().filter(function(){return"fixed"==jQuery(this).css("position")}).length<=0?"static":"fixed"),"fixed"==this.target.data("jBox-fixed")&&this.options.fixed&&(t.top=t.top-jQuery(window).scrollTop(),t.left=t.left-jQuery(window).scrollLeft()),this.targetDimensions={x:this.target.outerWidth(),y:this.target.outerHeight(),top:t?t.top:0,left:t?t.left:0},this.pos={},r=function(n){if(-1==jQuery.inArray(this.options.position[n],["top","right","bottom","left","center"]))return void(this.pos[this.options.attributes[n]]=this.options.position[n]);var t=this.options.attributes[n]="x"==n?"left":"top";return this.pos[t]=this.targetDimensions[t],"center"==this.options.position[n]?void(this.pos[t]+=Math.ceil((this.targetDimensions[n]-this.dimensions[n])/2)):(t!=this.options.position[n]&&(this.pos[t]+=this.targetDimensions[n]-this.dimensions[n]),void((this.options.outside==n||"xy"==this.options.outside)&&(this.pos[t]+=this.dimensions[n]*(t!=this.options.position[n]?1:-1))))}.bind(this),r("x"),r("y"),this.options.pointer&&"number"!=jQuery.type(this.options.position.x)&&"number"!=jQuery.type(this.options.position.y)){i=0;switch(this.pointer.align){case"center":"center"!=this.options.position[this._getOpp(this.options.outside)]&&(i+=this.dimensions[this._getOpp(this.options.outside)]/2);break;default:switch(this.options.position[this._getOpp(this.options.outside)]){case"center":i+=(this.dimensions[this._getOpp(this.options.outside)]/2-this.pointer.dimensions[this._getOpp(this.options.outside)]/2)*(this.pointer.align==this._getTL(this.pointer.align)?1:-1);break;default:i+=this.pointer.align!=this.options.position[this._getOpp(this.options.outside)]?this.dimensions[this._getOpp(this.options.outside)]*(-1!==jQuery.inArray(this.pointer.align,["top","left"])?1:-1)+this.pointer.dimensions[this._getOpp(this.options.outside)]/2*(-1!==jQuery.inArray(this.pointer.align,["top","left"])?-1:1):this.pointer.dimensions[this._getOpp(this.options.outside)]/2*(-1!==jQuery.inArray(this.pointer.align,["top","left"])?1:-1)}}i*=this.options.position[this._getOpp(this.options.outside)]==this.pointer.alignAttribute?-1:1;i+=this.pointer.offset*(this.pointer.align==this._getOpp(this._getTL(this.pointer.align))?1:-1);this.pos[this._getTL(this._getOpp(this.pointer.xy))]+=i}return n.adjustOffset&&n.adjustOffset.x&&(this.pos[this.options.attributes.x]+=parseInt(n.adjustOffset.x)*("left"==this.options.attributes.x?1:-1)),n.adjustOffset&&n.adjustOffset.y&&(this.pos[this.options.attributes.y]+=parseInt(n.adjustOffset.y)*("top"==this.options.attributes.y?1:-1)),this.pos[this.options.attributes.x]+=this.options.offset.x,this.pos[this.options.attributes.y]+=this.options.offset.y,this.wrapper.css(this.pos),this._adjustPosition(),this}};jBox.prototype.open=function(n){if(n||(n={}),this.isDestroyed)return!1;if(!this.wrapper&&this._create(),this.timer&&clearTimeout(this.timer),this._blockBodyClick(),this.isDisabled)return this;var t=function(){this.source&&this.options.getTitle&&(this.source.attr(this.options.getTitle)&&this.setTitle(this.source.attr(this.options.getTitle)),!0);this.source&&this.options.getContent&&(this.source.data("jBox-getContent")?this.setContent(this.source.data("jBox-getContent"),!0):this.source.attr(this.options.getContent)?this.setContent(this.source.attr(this.options.getContent),!0):null);this.options.onOpen.bind(this)();this.options._onOpen&&this.options._onOpen.bind(this)();(this.options.ajax&&this.options.ajax.url&&(!this.ajaxLoaded||this.options.ajax.reload)||n.ajax&&n.ajax.url)&&this.ajax(n.ajax||null);(!this.positionedOnOpen||this.options.repositionOnOpen)&&this.position({target:n.target})&&(this.positionedOnOpen=!0);this.isClosing&&this._abortAnimation();this.isOpen||(this.isOpen=!0,this._attachEvents(),this.options.blockScroll&&jQuery("body").addClass("jBox-blockScroll-"+this.id),this.options.overlay&&this._addOverlay(),this.options.animation&&!this.isClosing&&this._animate("open"),this.options.fade?this.wrapper.stop().animate({opacity:1},{queue:!1,duration:this.options.fade,start:function(){this.isOpening=!0;this.wrapper.css({display:"block"})}.bind(this),always:function(){this.isOpening=!1}.bind(this)}):this.wrapper.css({display:"block",opacity:1}))}.bind(this);return!this.options.delayOpen||this.isOpen||this.isClosing||n.ignoreDelay?t():this.timer=setTimeout(t,this.options.delayOpen),this};jBox.prototype.close=function(n){if(n||(n={}),this.isDestroyed)return!1;if(this.timer&&clearTimeout(this.timer),this._blockBodyClick(),this.isDisabled)return this;var t=function(){this.options.onClose.bind(this)();this.options._onClose&&this.options._onClose.bind(this)();this.isOpen&&(this.isOpen=!1,this._detachEvents(),this.options.blockScroll&&jQuery("body").removeClass("jBox-blockScroll-"+this.id),this.options.overlay&&this._removeOverlay(),this.options.animation&&!this.isOpening&&this._animate("close"),this.options.fade?this.wrapper.stop().animate({opacity:0},{queue:!1,duration:this.options.fade,start:function(){this.isClosing=!0}.bind(this),complete:function(){this.wrapper.css({display:"none"});this.options.onCloseComplete&&this.options.onCloseComplete.bind(this)();this.options._onCloseComplete&&this.options._onCloseComplete.bind(this)()}.bind(this),always:function(){this.isClosing=!1}.bind(this)}):(this.wrapper.css({display:"none",opacity:0}),this.options._onCloseComplete&&this.options._onCloseComplete.bind(this)()))}.bind(this);return n.ignoreDelay?t():this.timer=setTimeout(t,Math.max(this.options.delayClose,10)),this};jBox.prototype.toggle=function(n){return this[this.isOpen?"close":"open"](n),this};jBox.prototype.disable=function(){return this.isDisabled=!0,this};jBox.prototype.enable=function(){return this.isDisabled=!1,this};jBox.prototype.ajax=function(n){var i;n||(n={});this.options.ajax.getData&&!n.data&&this.source&&void 0!=this.source.attr(this.options.ajax.getData)&&(n.data=this.source.attr(this.options.ajax.getData)||"");i=jQuery.extend(!0,{},this.options.ajax);this.ajaxRequest&&this.ajaxRequest.abort();var r=n.beforeSend||i.beforeSend||function(){},u=n.complete||i.complete||function(){},t=jQuery.extend(!0,i,n);return t.beforeSend=function(){t.spinner&&(this.wrapper.addClass("jBox-loading"),this.spinner=jQuery(t.spinner!==!0?t.spinner:'<div class="jBox-spinner"><\/div>').appendTo(this.container));r.bind(this)()}.bind(this),t.complete=function(n){this.wrapper.removeClass("jBox-loading");this.spinner&&this.spinner.remove();t.setContent&&this.setContent(n.responseText);this.ajaxLoaded=!0;u.bind(this)(n)}.bind(this),this.ajaxRequest=jQuery.ajax(t),this};jBox.prototype.audio=function(n){if(n||(n={}),jBox._audio||(jBox._audio={}),!n.url||this.IE8)return this;if(!jBox._audio[n.url]){var t=jQuery("<audio/>");jQuery("<source/>",{src:n.url+".mp3"}).appendTo(t);jQuery("<source/>",{src:n.url+".ogg"}).appendTo(t);jBox._audio[n.url]=t[0]}jBox._audio[n.url].volume=Math.min(void 0!=n.volume?n.volume:(void 0!=this.options.volume?this.options.volume:100)/100,1);jBox._audio[n.url].pause();try{jBox._audio[n.url].currentTime=0}catch(i){}return jBox._audio[n.url].play(),this};jBox.prototype.destroy=function(){return this.detach().close({ignoreDelay:!0}),this.wrapper&&this.wrapper.remove(),this.isDestroyed=!0,this};jBox._getUniqueID=function(){var n=1;return function(){return n++}}();jQuery.fn.jBox=function(n,t){return n||(n={}),t||(t={}),new jBox(n,jQuery.extend(t,{attach:this}))};Function.prototype.bind||(Function.prototype.bind=function(n){var r=Array.prototype.slice.call(arguments,1),u=this,t=function(){},i=function(){return u.apply(this instanceof t&&n?this:n,r.concat(Array.prototype.slice.call(arguments)))};return t.prototype=this.prototype,i.prototype=new t,i})